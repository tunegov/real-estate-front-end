{"version":3,"file":"7.a11f509903915a55d139.hot-update.js","sources":["webpack:///src/containers/AdminDealsSummary.js"],"sourcesContent":["import React, { Component } from 'react';\nimport { observer } from 'mobx-react';\nimport moment from 'moment';\nimport setValue from 'set-value';\nimport AdminDealsSummary from '../components/AdminDealsSummary';\nimport {\n  residentialRental,\n  residentialSale,\n  commercialRental,\n  commercialSale,\n} from '../constants/dealTypes';\nimport { round } from '../utils/Math';\nimport {\n  returnMonthlyDollarDataContainer,\n  returnMonthlyDealNumberDataContainer,\n  returnNumberDealsDataContainer,\n  returnYearlyDollarDealsDataContainer,\n} from '../constants/graphDataModels';\nimport { toLocaleCurrency } from '../utils/currency';\n\nconst get = (p, o) => p.reduce((xs, x) => (xs && xs[x] ? xs[x] : null), o);\n\nconst returnGraphDealType = deal => {\n  let graphDealType;\n\n  switch (deal.dealType) {\n    case commercialRental:\n      graphDealType = 'Com Rentals';\n      break;\n    case commercialSale:\n      graphDealType = 'Com Sales';\n      break;\n    case residentialRental:\n      graphDealType = 'Res Rentals';\n      break;\n    case residentialSale:\n      graphDealType = 'Res Sales';\n      break;\n    default:\n      return null;\n  }\n  return graphDealType;\n};\n\nconst returnGraphMonth = month => {\n  const months = [\n    'Jan',\n    'Feb',\n    'Mar',\n    'Apr',\n    'May',\n    'Jun',\n    'Jul',\n    'Aug',\n    'Sep',\n    'Oct',\n    'Nov',\n    'Dec',\n  ];\n\n  return months[month];\n};\n\n@observer\nclass AdminDealsSummaryContainer extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {};\n  }\n\n  returnNumberOfTotalDealsData = (deals = []) => {\n    if (!deals.length) return false;\n\n    const dealDataCounts = {\n      'Res. Sales': 0,\n      'Res. Rentals': 0,\n      'Com. Sales': 0,\n      'Com. Rentals': 0,\n    };\n\n    if (deals && Array.isArray(deals)) {\n      deals.forEach(deal => {\n        switch (deal.dealType) {\n          case commercialRental:\n            dealDataCounts['Com. Rentals'] += 1;\n            break;\n          case commercialSale:\n            dealDataCounts['Com. Sales'] += 1;\n            break;\n          case residentialRental:\n            dealDataCounts['Res. Rentals'] += 1;\n            break;\n          case residentialSale:\n            dealDataCounts['Res. Sales'] += 1;\n            break;\n          default:\n        }\n      });\n    }\n\n    const dealData = [\n      {\n        id: 'Res. Sales',\n        label: 'Res. Sales',\n        value: dealDataCounts['Res. Sales'] || 0,\n      },\n      {\n        id: 'Res. Rentals',\n        label: 'Res. Rentals',\n        value: dealDataCounts['Res. Rentals'] || 0,\n      },\n      {\n        id: 'Com. Sales',\n        label: 'Com. Sales',\n        value: dealDataCounts['Com. Sales'] || 0,\n      },\n      {\n        id: 'Com. Rentals',\n        label: 'Com. Rentals',\n        value: dealDataCounts['Com. Rentals'] || 0,\n      },\n    ];\n\n    return dealData;\n  };\n\n  returnDollarAmtOfTotalDealsData = (deals = []) => {\n    if (!deals.length) return false;\n\n    const grossDealDataCounts = {\n      'Res. Sales': 0,\n      'Res. Rentals': 0,\n      'Com. Sales': 0,\n      'Com. Rentals': 0,\n    };\n\n    const netDealDataCounts = {\n      'Res. Sales': 0,\n      'Res. Rentals': 0,\n      'Com. Sales': 0,\n      'Com. Rentals': 0,\n    };\n\n    if (deals) {\n      deals.forEach(deal => {\n        if (deal.status === 'pending') return;\n\n        switch (deal.dealType) {\n          case commercialRental:\n            grossDealDataCounts['Com. Rentals'] += deal.total;\n            netDealDataCounts['Com. Rentals'] += deal.netCompanyCommission;\n            break;\n          case commercialSale:\n            grossDealDataCounts['Com. Sales'] += deal.total;\n            netDealDataCounts['Com. Sales'] += deal.netCompanyCommission;\n            break;\n          case residentialRental:\n            grossDealDataCounts['Res. Rentals'] += deal.total;\n            netDealDataCounts['Res. Rentals'] += deal.netCompanyCommission;\n            break;\n          case residentialSale:\n            grossDealDataCounts['Res. Sales'] += deal.total;\n            netDealDataCounts['Res. Sales'] += deal.netCompanyCommission;\n            break;\n          default:\n        }\n      });\n    }\n\n    const grossDealsDollarData = [\n      {\n        id: 'Res. Sales',\n        label: 'Res. Sales',\n        value: grossDealDataCounts['Res. Sales'] || 0,\n      },\n      {\n        id: 'Res. Rentals',\n        label: 'Res. Rentals',\n        value: grossDealDataCounts['Res. Rentals'] || 0,\n      },\n      {\n        id: 'Com. Sales',\n        label: 'Com. Sales',\n        value: grossDealDataCounts['Com. Sales'] || 0,\n      },\n      {\n        id: 'Com. Rentals',\n        label: 'Com. Rentals',\n        value: grossDealDataCounts['Com. Rentals'] || 0,\n      },\n    ];\n\n    const netDealsDollarData = [\n      {\n        id: 'Res. Sales',\n        label: 'Res. Sales',\n        value: netDealDataCounts['Res. Sales'] || 0,\n      },\n      {\n        id: 'Res. Rentals',\n        label: 'Res. Rentals',\n        value: netDealDataCounts['Res. Rentals'] || 0,\n      },\n      {\n        id: 'Com. Sales',\n        label: 'Com. Sales',\n        value: netDealDataCounts['Com. Sales'] || 0,\n      },\n      {\n        id: 'Com. Rentals',\n        label: 'Com. Rentals',\n        value: netDealDataCounts['Com. Rentals'] || 0,\n      },\n    ];\n\n    return { grossDealsDollarData, netDealsDollarData };\n  };\n\n  returnNumberOfPendingDeals = (deals = []) => {\n    const numOfPendingDeals = deals.reduce((pendingDeals, deal) => {\n      if (deal.status === 'pending') {\n        return (pendingDeals += 1);\n      }\n\n      return pendingDeals;\n    }, 0);\n\n    return numOfPendingDeals || 0;\n  };\n\n  returnGrossDealCommissions = (deals = []) => toLocaleCurrency(deals.reduce((grossAmount, deal) => {\n    if (deal.status === 'pending') return grossAmount;\n\n    return grossAmount += deal.total;\n  }, 0));\n\n  returnNetDealCommissions = (deals = []) => toLocaleCurrency(deals.reduce((grossAmount, deal) => {\n    if (deal.status === 'pending') return grossAmount;\n\n    return grossAmount += deal.netCompanyCommission;\n  }, 0));\n\n  returnNetCurrentYearDealCommissions = (deals = []) => toLocaleCurrency(deals.reduce((grossAmount, deal) => {\n    if (deal.status === 'pending') return grossAmount;\n    if (moment(deal.date).year() !== moment().year()) return grossAmount;\n\n    return grossAmount += deal.netCompanyCommission;\n  }, 0));\n\n  returnMonthlyAndYearlyDealsData = (deals = []) => {\n    const monthlyDollarData = returnMonthlyDollarDataContainer();\n    const grossMonthlyDollarData = returnMonthlyDollarDataContainer();\n    const monthlyDealNumberData = returnMonthlyDealNumberDataContainer();\n    const yearlyDollarData = returnNumberDealsDataContainer();\n    const grossYearlyDollarData = returnNumberDealsDataContainer();\n    const yearlyDealNumberData = returnYearlyDollarDealsDataContainer();\n\n    deals.forEach(deal => {\n      if (deal.status === 'pending') return;\n\n      const month = moment(deal.date).month();\n      const year = moment(deal.date).year();\n      const currentYear = moment().year();\n      const yearLimit = currentYear - 4;\n\n      // gross monthlyDollarData\n      if (\n        get(\n          [returnGraphMonth(month), returnGraphDealType(deal)],\n          grossMonthlyDollarData\n        )\n      ) {\n        grossMonthlyDollarData[returnGraphMonth(month)][\n          returnGraphDealType(deal)\n        ] += round(deal.total / 1000);\n      } else {\n        setValue(\n          grossMonthlyDollarData,\n          `${returnGraphMonth(month)}.${returnGraphDealType(deal)}`,\n          round(deal.total / 1000)\n        );\n      }\n\n      // net monthlyDollarData\n      if (\n        get(\n          [returnGraphMonth(month), returnGraphDealType(deal)],\n          monthlyDollarData\n        )\n      ) {\n        monthlyDollarData[returnGraphMonth(month)][\n          returnGraphDealType(deal)\n        ] += round(deal.netCompanyCommission / 1000);\n      } else {\n        setValue(\n          monthlyDollarData,\n          `${returnGraphMonth(month)}.${returnGraphDealType(deal)}`,\n          round(deal.netCompanyCommission / 1000)\n        );\n      }\n\n      // monthlyDealNumberData\n      if (\n        get(\n          [returnGraphMonth(month), returnGraphDealType(deal)],\n          monthlyDealNumberData\n        )\n      ) {\n        monthlyDealNumberData[returnGraphMonth(month)][\n          returnGraphDealType(deal)\n        ] += 1;\n      } else {\n        setValue(\n          monthlyDealNumberData,\n          `${returnGraphMonth(month)}.${returnGraphDealType(deal)}`,\n          1\n        );\n      }\n\n      if (year >= yearLimit) {\n        // gross yearlyDollarData\n        if (get([year, returnGraphDealType(deal)], yearlyDollarData)) {\n          grossYearlyDollarData[year][returnGraphDealType(deal)] += round(\n            deal.total / 1000\n          );\n        } else {\n          setValue(\n            grossYearlyDollarData,\n            `${year}.${returnGraphDealType(deal)}`,\n            round(deal.total / 1000)\n          );\n        }\n\n        // yearlyDollarData\n        if (get([year, returnGraphDealType(deal)], yearlyDollarData)) {\n          yearlyDollarData[year][returnGraphDealType(deal)] += round(\n            deal.netCompanyCommission / 1000\n          );\n        } else {\n          setValue(\n            yearlyDollarData,\n            `${year}.${returnGraphDealType(deal)}`,\n            round(deal.netCompanyCommission / 1000)\n          );\n        }\n\n        // yearlyDealNumberData\n        if (get([year, returnGraphDealType(deal)], yearlyDealNumberData)) {\n          yearlyDealNumberData[year][returnGraphDealType(deal)] += 1;\n        } else {\n          setValue(\n            yearlyDealNumberData,\n            `${year}.${returnGraphDealType(deal)}`,\n            1\n          );\n        }\n      }\n    });\n\n    return {\n      monthlyDollarData,\n      grossMonthlyDollarData,\n      monthlyDealNumberData,\n      yearlyDollarData,\n      grossYearlyDollarData,\n      yearlyDealNumberData,\n    };\n  };\n\n  generateDealsBarData = data => Object.keys(data).map(month => ({\n    month,\n    'Com Sales': round(data[month]['Com Sales']),\n    'Com Rentals': round(data[month]['Com Rentals']),\n    'Res Sales': round(data[month]['Res Sales']),\n    'Res Rentals': round(data[month]['Res Rentals']),\n  }));\n\n  generateDealsLineData = data => {\n    const types = ['Com Sales', 'Com Rentals', 'Res Sales', 'Res Rentals'];\n\n    return types.map(id => ({\n      id,\n      data: Object.keys(data).map(month => ({\n        x: month,\n        y: data[month][id],\n      })),\n    }));\n  };\n\n  returnAllGraphData = deals => {\n    const {\n      monthlyDollarData,\n      grossMonthlyDollarData,\n      monthlyDealNumberData,\n      yearlyDollarData,\n      grossYearlyDollarData,\n      yearlyDealNumberData,\n    } = this.returnMonthlyAndYearlyDealsData(deals);\n\n    return {\n      monthlyDealsDollarBarData: this.generateDealsBarData(monthlyDollarData),\n      grossMonthlyDealsDollarBarData: this.generateDealsBarData(\n        grossMonthlyDollarData\n      ),\n      monthlyDealsNumberBarData: this.generateDealsBarData(\n        monthlyDealNumberData\n      ),\n      monthlyDealsDollarLineData: this.generateDealsLineData(monthlyDollarData),\n      grossMonthlyDealsDollarLineData: this.generateDealsLineData(\n        grossMonthlyDollarData\n      ),\n      monthlyDealsNumberLineData: this.generateDealsLineData(\n        monthlyDealNumberData\n      ),\n      yearlyDealsDollarBarData: this.generateDealsBarData(yearlyDollarData),\n      grossYearlyDealsDollarBarData: this.generateDealsBarData(\n        grossYearlyDollarData\n      ),\n      yearlyDealsNumberBarData: this.generateDealsBarData(yearlyDealNumberData),\n      yearlyDealsDollarLineData: this.generateDealsLineData(yearlyDollarData),\n      grossYearlyDealsDollarLineData: this.generateDealsLineData(\n        grossYearlyDollarData\n      ),\n      yearlyDealsNumberLineData: this.generateDealsLineData(\n        yearlyDealNumberData\n      ),\n    };\n  };\n\n  render() {\n    const { deals, userUUID } = this.props;\n\n    const {\n      monthlyDealsDollarBarData,\n      grossMonthlyDealsDollarBarData,\n      monthlyDealsNumberBarData,\n      monthlyDealsDollarLineData,\n      grossMonthlyDealsDollarLineData,\n      monthlyDealsNumberLineData,\n      yearlyDealsDollarBarData,\n      grossYearlyDealsDollarBarData,\n      yearlyDealsNumberBarData,\n      yearlyDealsDollarLineData,\n      grossYearlyDealsDollarLineData,\n      yearlyDealsNumberLineData,\n    } = this.returnAllGraphData(deals);\n\n    const {\n      grossDealsDollarData,\n      netDealsDollarData,\n    } = this.returnDollarAmtOfTotalDealsData(deals);\n\n    return (\n      <div>\n        <AdminDealsSummary\n          userUUID={userUUID}\n          numberOfTotalDealsData={this.returnNumberOfTotalDealsData(deals)}\n          grossDollarAmtOfTotalDealsData={grossDealsDollarData}\n          netDollarAmtOfTotalDealsData={netDealsDollarData}\n          numberOfPendingDeals={this.returnNumberOfPendingDeals(deals)}\n          grossDealCommissions={this.returnGrossDealCommissions(deals)}\n          netDealCommissions={this.returnNetDealCommissions(deals)}\n          netCurrentYearDealCommissions={this.returnNetCurrentYearDealCommissions(\n            deals\n          )}\n          monthlyDealsDollarBarData={monthlyDealsDollarBarData}\n          grossMonthlyDealsDollarBarData={grossMonthlyDealsDollarBarData}\n          monthlyDealsNumberBarData={monthlyDealsNumberBarData}\n          monthlyDealsDollarLineData={monthlyDealsDollarLineData}\n          grossMonthlyDealsDollarLineData={grossMonthlyDealsDollarLineData}\n          monthlyDealsNumberLineData={monthlyDealsNumberLineData}\n          yearlyDealsDollarBarData={yearlyDealsDollarBarData}\n          grossYearlyDealsDollarBarData={grossYearlyDealsDollarBarData}\n          yearlyDealsNumberBarData={yearlyDealsNumberBarData}\n          yearlyDealsDollarLineData={yearlyDealsDollarLineData}\n          grossYearlyDealsDollarLineData={grossYearlyDealsDollarLineData}\n          yearlyDealsNumberLineData={yearlyDealsNumberLineData}\n        />\n      </div>\n    );\n  }\n}\n\nexport default AdminDealsSummaryContainer;\n\n\n\n// WEBPACK FOOTER //\n// src/containers/AdminDealsSummary.js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AAMA;AACA;AAMA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AAdA;AACA;AAeA;AACA;AACA;AACA;AACA;AAeA;AACA;AACA;AAEA;;;;;AACA;AAAA;AACA;AADA;AACA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AAEA;AACA;AACA;AACA;AACA;AAJA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAbA;AAeA;AACA;AACA;AACA;AAEA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAHA;AAOA;AACA;AA5DA;AAAA;AAAA;AAAA;AAAA;AAAA;AA8DA;AACA;AAEA;AACA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AACA;AACA;AAJA;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAjBA;AAmBA;AACA;AACA;AACA;AAEA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAHA;AAOA;AAEA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAHA;AAMA;AACA;AACA;AAHA;AAOA;AAAA;AAAA;AAAA;AACA;AAxJA;AAAA;AAAA;AAAA;AAAA;AAAA;AA0JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AApKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAsKA;AAAA;AACA;AAEA;AACA;AAJA;AAtKA;AAAA;AAAA;AAAA;AAAA;AAAA;AA4KA;AAAA;AACA;AAEA;AACA;AAJA;AA5KA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkLA;AAAA;AACA;AACA;AAEA;AACA;AALA;AAlLA;AAAA;AAAA;AAAA;AAAA;AAAA;AAyLA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAMA;AAGA;AACA;AAKA;AACA;AACA;AACA;AAMA;AAGA;AACA;AAKA;AACA;AACA;AACA;AAMA;AAGA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAKA;AACA;AACA;AACA;AACA;AAGA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AAKA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AANA;AAQA;AA/SA;AAAA;AAAA;AAAA;AAAA;AAAA;AAiTA;AAAA;AACA;AACA;AACA;AACA;AACA;AALA;AAAA;AAAA;AAjTA;AAAA;AAAA;AAAA;AAAA;AAAA;AA0TA;AAEA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAFA;AAAA;AAFA;AAAA;AAOA;AAnUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAqUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AASA;AACA;AACA;AAGA;AAGA;AACA;AAGA;AAGA;AACA;AAGA;AACA;AACA;AAGA;AAxBA;AA4BA;AA3WA;AAGA;AAHA;AAIA;AACA;;;AAwWA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAsBA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAtBA;AAAA;AAAA;AAAA;AAAA;AA0BA;;;;;;;;;;;AAjaA;AACA;AAmaA;AAAA;;;;;;;;;;;;AAhdA;AAEA;AAsBA;AAoBA;;;;;;;;;;A","sourceRoot":""}